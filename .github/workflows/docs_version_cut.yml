name: Docs Version Cut

on:
  push:
    tags:
      - 'v*'

permissions:
  contents: read

jobs:
  cut-version:
    name: Validate docs for release tag
    runs-on: ubuntu-latest
    timeout-minutes: 20
    steps:
      - uses: actions/checkout@v4
        with:
          ref: ${{ github.ref }}
          fetch-depth: 0

      - name: Setup Dart
        uses: dart-lang/setup-dart@v1
        with:
          cache: true

      - name: Validate docs build and links
        run: |
          VERSION="${GITHUB_REF_NAME#v}"
          echo "Validating docs for tag v${VERSION}."
          ./tool/docs/validate_links.sh
